<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 22 SQL and Java | DataManagement.knit</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 22 SQL and Java | DataManagement.knit" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 22 SQL and Java | DataManagement.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-processing-architectures.html"/>
<link rel="next" href="data-integrity.html"/>
<script src="libs/header-attrs-2.12/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="data-management-databases-and-organizations.html#data-management-databases-and-organizations">Data Management: Databases and Organizations<span></span></a></li>
<li><a href="preface.html#preface">Preface<span></span></a>
<ul>
<li><a href="preface.html#supplements">Supplements<span></span></a></li>
<li><a href="preface.html#acknowledgments">Acknowledgments<span></span></a></li>
</ul></li>
<li><a href="section-1-the-managerial-perspective.html#section-1-the-managerial-perspective">Section 1 The Managerial Perspective<span></span></a></li>
<li class="chapter" data-level="1" data-path="managing-data.html"><a href="managing-data.html"><i class="fa fa-check"></i><b>1</b> Managing Data<span></span></a>
<ul>
<li><a href="managing-data.html#introduction">Introduction<span></span></a></li>
<li><a href="managing-data.html#individual-data-management">Individual data management<span></span></a></li>
<li><a href="managing-data.html#organizational-data-management">Organizational data management<span></span></a></li>
<li><a href="managing-data.html#problems-with-data-management-systems">Problems with data management systems<span></span></a></li>
<li><a href="managing-data.html#a-brief-history-of-data-management-systems">A brief history of data management systems<span></span></a></li>
<li><a href="managing-data.html#data-information-and-knowledge">Data, information, and knowledge<span></span></a></li>
<li><a href="managing-data.html#the-challenge">The challenge<span></span></a></li>
<li><a href="managing-data.html#exercises">Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="information.html"><a href="information.html"><i class="fa fa-check"></i><b>2</b> Information<span></span></a>
<ul>
<li><a href="information.html#introduction-1">Introduction<span></span></a></li>
<li><a href="information.html#a-historical-perspective">A historical perspective<span></span></a></li>
<li><a href="information.html#a-brief-history-of-information-systems">A brief history of information systems<span></span></a></li>
<li><a href="information.html#information-characteristics">Information characteristics<span></span></a></li>
<li><a href="information.html#information-and-organizational-change">Information and organizational change<span></span></a></li>
<li><a href="information.html#information-and-managerial-work">Information and managerial work<span></span></a></li>
<li><a href="information.html#managers-information-requirements">Managers’ information requirements<span></span></a></li>
<li><a href="information.html#information-delivery-systems">Information delivery systems<span></span></a></li>
<li><a href="information.html#information-integration">Information integration<span></span></a></li>
<li><a href="information.html#knowledge-1">Knowledge<span></span></a></li>
<li><a href="information.html#exercises-1">Exercises<span></span></a></li>
</ul></li>
<li><a href="section-2-data-modeling-and-sql.html#section-2-data-modeling-and-sql">Section 2 Data Modeling and SQL<span></span></a></li>
<li class="chapter" data-level="3" data-path="the-single-entity.html"><a href="the-single-entity.html"><i class="fa fa-check"></i><b>3</b> The Single Entity<span></span></a>
<ul>
<li><a href="the-single-entity.html#the-relational-model">The relational model<span></span></a></li>
<li><a href="the-single-entity.html#getting-started">Getting started<span></span></a></li>
<li><a href="the-single-entity.html#modeling-a-single-entity-database">Modeling a single-entity database<span></span></a></li>
<li><a href="the-single-entity.html#creating-a-single-table-database">Creating a single-table database<span></span></a></li>
<li><a href="the-single-entity.html#querying-a-single-table-database">Querying a single-table database<span></span></a></li>
<li><a href="the-single-entity.html#exercises-2">Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="the-one-to-many-relationship.html"><a href="the-one-to-many-relationship.html"><i class="fa fa-check"></i><b>4</b> The One-to-Many Relationship<span></span></a>
<ul>
<li><a href="the-one-to-many-relationship.html#relationships">Relationships<span></span></a></li>
<li><a href="the-one-to-many-relationship.html#creating-a-database-with-a-1m-relationship">Creating a database with a 1:m relationship<span></span></a></li>
<li><a href="the-one-to-many-relationship.html#querying-a-two-table-database">Querying a two-table database<span></span></a></li>
<li><a href="the-one-to-many-relationship.html#regular-expressionpattern-matching-1">Regular expression—pattern matching<span></span></a></li>
<li><a href="the-one-to-many-relationship.html#subqueries-1">Subqueries<span></span></a></li>
<li><a href="the-one-to-many-relationship.html#exercises-3">Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-many-to-many-relationship.html"><a href="the-many-to-many-relationship.html"><i class="fa fa-check"></i><b>5</b> The Many-to-Many Relationship<span></span></a>
<ul>
<li><a href="the-many-to-many-relationship.html#the-many-to-many-relationship-1">The many-to-many relationship<span></span></a></li>
<li><a href="the-many-to-many-relationship.html#creating-a-relational-database-with-an-mm-relationship">Creating a relational database with an m:m relationship<span></span></a></li>
<li><a href="the-many-to-many-relationship.html#querying-an-mm-relationship">Querying an m:m relationship<span></span></a></li>
<li><a href="the-many-to-many-relationship.html#key-terms-and-concepts-2">Key terms and concepts<span></span></a></li>
<li><a href="the-many-to-many-relationship.html#exercises-4">Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="one-to-one-and-recursive-relationships.html"><a href="one-to-one-and-recursive-relationships.html"><i class="fa fa-check"></i><b>6</b> One-to-One and Recursive Relationships<span></span></a>
<ul>
<li><a href="one-to-one-and-recursive-relationships.html#modeling-a-one-to-one-relationship">Modeling a one-to-one relationship<span></span></a></li>
<li><a href="one-to-one-and-recursive-relationships.html#mapping-a-one-to-one-relationship">Mapping a one-to-one relationship<span></span></a></li>
<li><a href="one-to-one-and-recursive-relationships.html#mapping-a-recursive-one-to-many-relationship">Mapping a recursive one-to-many relationship<span></span></a></li>
<li><a href="one-to-one-and-recursive-relationships.html#querying-a-one-to-one-relationship">Querying a one-to-one relationship<span></span></a></li>
<li><a href="one-to-one-and-recursive-relationships.html#querying-a-recursive-1m-relationship">Querying a recursive 1:m relationship<span></span></a></li>
<li><a href="one-to-one-and-recursive-relationships.html#modeling-a-recursive-one-to-one-relationship">Modeling a recursive one-to-one relationship<span></span></a></li>
<li><a href="one-to-one-and-recursive-relationships.html#mapping-a-recursive-one-to-one-relationship">Mapping a recursive one-to-one relationship<span></span></a></li>
<li><a href="one-to-one-and-recursive-relationships.html#querying-a-recursive-one-to-one-relationship">Querying a recursive one-to-one relationship<span></span></a></li>
<li><a href="one-to-one-and-recursive-relationships.html#modeling-a-recursive-many-to-many-relationship">Modeling a recursive many-to-many relationship<span></span></a></li>
<li><a href="one-to-one-and-recursive-relationships.html#mapping-a-recursive-many-to-many-relationship">Mapping a recursive many-to-many relationship<span></span></a></li>
<li><a href="one-to-one-and-recursive-relationships.html#querying-a-recursive-many-to-many-relationship">Querying a recursive many-to-many relationship<span></span></a></li>
<li><a href="one-to-one-and-recursive-relationships.html#exercises-5">Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-modeling.html"><a href="data-modeling.html"><i class="fa fa-check"></i><b>7</b> Data Modeling<span></span></a>
<ul>
<li><a href="data-modeling.html#modeling">Modeling<span></span></a></li>
<li><a href="data-modeling.html#data-modeling-1">Data modeling<span></span></a></li>
<li><a href="data-modeling.html#data-model-quality">Data model quality<span></span></a></li>
<li><a href="data-modeling.html#quality-improvement">Quality improvement<span></span></a></li>
<li><a href="data-modeling.html#data-modeling-hints">Data modeling hints<span></span></a></li>
<li><a href="data-modeling.html#the-seven-habits-of-highly-effective-data-modelers">The seven habits of highly effective data modelers<span></span></a></li>
<li><a href="data-modeling.html#exercises-6">Exercises<span></span></a></li>
</ul></li>
<li><a href="reference-1-basic-structures.html#reference-1-basic-structures">Reference 1: Basic Structures<span></span></a>
<ul>
<li><a href="reference-1-basic-structures.html#one-entity">One entity<span></span></a></li>
<li><a href="reference-1-basic-structures.html#two-entities">Two entities<span></span></a></li>
<li><a href="reference-1-basic-structures.html#another-entitys-identifier-as-part-of-the-identifier">Another entity’s identifier as part of the identifier<span></span></a></li>
<li><a href="reference-1-basic-structures.html#exercises-7">Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="normalization-and-other-data-modeling-methods.html"><a href="normalization-and-other-data-modeling-methods.html"><i class="fa fa-check"></i><b>8</b> Normalization and Other Data Modeling Methods<span></span></a>
<ul>
<li><a href="normalization-and-other-data-modeling-methods.html#multiple-paths">Multiple paths<span></span></a></li>
<li><a href="normalization-and-other-data-modeling-methods.html#normalization">Normalization<span></span></a></li>
<li><a href="normalization-and-other-data-modeling-methods.html#other-data-modeling-methods">Other data modeling methods<span></span></a></li>
<li><a href="normalization-and-other-data-modeling-methods.html#key-terms-and-concepts-5">Key terms and concepts<span></span></a></li>
<li><a href="normalization-and-other-data-modeling-methods.html#exercises-8">Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="the-relational-model-and-relational-algebra.html"><a href="the-relational-model-and-relational-algebra.html"><i class="fa fa-check"></i><b>9</b> The Relational Model and Relational Algebra<span></span></a>
<ul>
<li><a href="the-relational-model-and-relational-algebra.html#background">Background<span></span></a></li>
<li><a href="the-relational-model-and-relational-algebra.html#data-structures">Data structures<span></span></a></li>
<li><a href="the-relational-model-and-relational-algebra.html#integrity-rules">Integrity rules<span></span></a></li>
<li><a href="the-relational-model-and-relational-algebra.html#manipulation-languages">Manipulation languages<span></span></a></li>
<li><a href="the-relational-model-and-relational-algebra.html#a-fully-relational-database">A fully relational database<span></span></a></li>
<li><a href="the-relational-model-and-relational-algebra.html#exercises-9">Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sql.html"><a href="sql.html"><i class="fa fa-check"></i><b>10</b> SQL<span></span></a>
<ul>
<li><a href="sql.html#structured-query-language">Structured query language<span></span></a></li>
<li><a href="sql.html#creating-a-table">Creating a table<span></span></a></li>
<li><a href="sql.html#data-types">Data types<span></span></a></li>
<li><a href="sql.html#collation-sequence">Collation sequence<span></span></a></li>
<li><a href="sql.html#scalar-functions">Scalar functions<span></span></a></li>
<li><a href="sql.html#formatting">Formatting<span></span></a></li>
<li><a href="sql.html#table-commands">Table commands<span></span></a></li>
<li><a href="sql.html#data-manipulation">Data manipulation<span></span></a></li>
<li><a href="sql.html#insert">INSERT<span></span></a></li>
<li><a href="sql.html#update-1">UPDATE<span></span></a></li>
<li><a href="sql.html#delete-1">DELETE<span></span></a></li>
<li><a href="sql.html#sql-routines">SQL routines<span></span></a></li>
<li><a href="sql.html#universal-unique-identifier-uuid">Universal Unique Identifier (UUID)<span></span></a></li>
<li><a href="sql.html#nullsmuch-ado-about-missing-information">Nulls—much ado about missing information<span></span></a></li>
<li><a href="sql.html#security">Security<span></span></a></li>
<li><a href="sql.html#the-system-catalog">The system catalog<span></span></a></li>
<li><a href="sql.html#natural-language-processing">Natural language processing<span></span></a></li>
<li><a href="sql.html#connectivity-and-odbc">Connectivity and ODBC<span></span></a></li>
<li><a href="sql.html#embedded-sql">Embedded SQL<span></span></a></li>
<li><a href="sql.html#user-defined-types">User-defined types<span></span></a></li>
<li><a href="sql.html#the-future-of-sql">The future of SQL<span></span></a></li>
</ul></li>
<li><a href="reference-2-sql-playbook.html#reference-2-sql-playbook">Reference 2: SQL Playbook<span></span></a>
<ul>
<li><a href="reference-2-sql-playbook.html#the-power-of-sql">The power of SQL<span></span></a></li>
</ul></li>
<li><a href="section-3-advanced-data-management.html#section-3-advanced-data-management">Section 3 Advanced Data Management<span></span></a></li>
<li class="chapter" data-level="11" data-path="spatial-and-temporal-data-management.html"><a href="spatial-and-temporal-data-management.html"><i class="fa fa-check"></i><b>11</b> Spatial and Temporal Data Management<span></span></a>
<ul>
<li><a href="spatial-and-temporal-data-management.html#spatial-data">Spatial data<span></span></a></li>
<li><a href="spatial-and-temporal-data-management.html#managing-spatial-data">Managing spatial data<span></span></a></li>
<li><a href="spatial-and-temporal-data-management.html#data-model-mapping">Data model mapping<span></span></a></li>
<li><a href="spatial-and-temporal-data-management.html#r-tree">R-tree<span></span></a></li>
<li><a href="spatial-and-temporal-data-management.html#managing-temporal-data">Managing temporal data<span></span></a></li>
<li><a href="spatial-and-temporal-data-management.html#key-terms-and-concepts-8">Key terms and concepts<span></span></a></li>
<li><a href="spatial-and-temporal-data-management.html#exercises-11">Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="graph-databases.html"><a href="graph-databases.html"><i class="fa fa-check"></i><b>12</b> Graph Databases<span></span></a>
<ul>
<li><a href="graph-databases.html#a-graph-database">A graph database<span></span></a></li>
<li><a href="graph-databases.html#neo4j-a-graph-database-implementation">Neo4j – a graph database implementation<span></span></a></li>
<li><a href="graph-databases.html#a-relationship-between-nodes">A relationship between nodes<span></span></a></li>
<li><a href="graph-databases.html#key-terms-and-concepts-9">Key terms and concepts<span></span></a></li>
<li><a href="graph-databases.html#exercises-12">Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="xml-managing-data-exchange.html"><a href="xml-managing-data-exchange.html"><i class="fa fa-check"></i><b>13</b> XML: Managing Data Exchange<span></span></a>
<ul>
<li><a href="xml-managing-data-exchange.html#four-problems">Four problems<span></span></a></li>
<li><a href="xml-managing-data-exchange.html#sgml">SGML<span></span></a></li>
<li><a href="xml-managing-data-exchange.html#xml">XML<span></span></a></li>
<li><a href="xml-managing-data-exchange.html#xml-schema">XML schema<span></span></a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="organizational-intelligence.html"><a href="organizational-intelligence.html"><i class="fa fa-check"></i><b>14</b> Organizational Intelligence<span></span></a>
<ul>
<li><a href="organizational-intelligence.html#information-poverty">Information poverty<span></span></a></li>
<li><a href="organizational-intelligence.html#an-organizational-intelligence-system">An organizational intelligence system<span></span></a></li>
<li><a href="organizational-intelligence.html#the-data-warehouse">The data warehouse<span></span></a></li>
<li><a href="organizational-intelligence.html#exploiting-data-stores">Exploiting data stores<span></span></a></li>
<li><a href="organizational-intelligence.html#data-mining">Data mining<span></span></a></li>
<li><a href="organizational-intelligence.html#exercises-14">Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>15</b> Introduction to R<span></span></a>
<ul>
<li><a href="introduction-to-r.html#the-r-project">The R project<span></span></a></li>
<li><a href="introduction-to-r.html#datasets">Datasets<span></span></a></li>
<li><a href="introduction-to-r.html#packages">Packages<span></span></a></li>
<li><a href="introduction-to-r.html#file-handing">File handing<span></span></a></li>
<li><a href="introduction-to-r.html#data-manipulation-with-dplyr">Data manipulation with dplyr<span></span></a></li>
<li><a href="introduction-to-r.html#database-access">Database access<span></span></a></li>
<li><a href="introduction-to-r.html#excel-files">Excel files<span></span></a></li>
<li><a href="introduction-to-r.html#r-resources">R resources<span></span></a></li>
<li><a href="introduction-to-r.html#r-and-data-analytics">R and data analytics<span></span></a></li>
<li><a href="introduction-to-r.html#exercises-15">Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="data-visualization-1.html"><a href="data-visualization-1.html"><i class="fa fa-check"></i><b>16</b> Data visualization<span></span></a>
<ul>
<li><a href="data-visualization-1.html#visual-processing">Visual processing<span></span></a></li>
<li><a href="data-visualization-1.html#the-grammar-of-graphics">The grammar of graphics<span></span></a></li>
<li><a href="data-visualization-1.html#ggplot2">ggplot2<span></span></a></li>
<li><a href="data-visualization-1.html#some-recipes">Some recipes<span></span></a></li>
<li><a href="data-visualization-1.html#geographic-data">Geographic data<span></span></a></li>
<li><a href="data-visualization-1.html#r-resources-1">R resources<span></span></a></li>
<li><a href="data-visualization-1.html#exercises-16">Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="text-mining-natural-language-processing.html"><a href="text-mining-natural-language-processing.html"><i class="fa fa-check"></i><b>17</b> Text mining &amp; natural language processing<span></span></a>
<ul>
<li><a href="text-mining-natural-language-processing.html#the-nature-of-language">The nature of language<span></span></a></li>
<li><a href="text-mining-natural-language-processing.html#levels-of-processing">Levels of processing<span></span></a></li>
<li><a href="text-mining-natural-language-processing.html#tokenization">Tokenization<span></span></a></li>
<li><a href="text-mining-natural-language-processing.html#sentiment-analysis">Sentiment analysis<span></span></a></li>
<li><a href="text-mining-natural-language-processing.html#corpus">Corpus<span></span></a></li>
<li><a href="text-mining-natural-language-processing.html#readability">Readability<span></span></a></li>
<li><a href="text-mining-natural-language-processing.html#preprocessing">Preprocessing<span></span></a></li>
<li><a href="text-mining-natural-language-processing.html#word-frequency-analysis">Word frequency analysis<span></span></a></li>
<li><a href="text-mining-natural-language-processing.html#co-occurrence-and-association">Co-occurrence and association<span></span></a></li>
<li><a href="text-mining-natural-language-processing.html#cluster-analysis">Cluster analysis<span></span></a></li>
<li><a href="text-mining-natural-language-processing.html#topic-modeling">Topic modeling<span></span></a></li>
<li><a href="text-mining-natural-language-processing.html#named-entity-recognition-ner">Named-entity recognition (NER)<span></span></a></li>
<li><a href="text-mining-natural-language-processing.html#future-developments">Future developments<span></span></a></li>
<li><a href="text-mining-natural-language-processing.html#key-terms-and-concepts-13">Key terms and concepts<span></span></a></li>
<li><a href="text-mining-natural-language-processing.html#exercises-17">Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="cluster-computing.html"><a href="cluster-computing.html"><i class="fa fa-check"></i><b>18</b> Cluster computing<span></span></a>
<ul>
<li><a href="cluster-computing.html#a-paradigm-shift">A paradigm shift<span></span></a></li>
<li><a href="cluster-computing.html#the-drivers">The drivers<span></span></a></li>
<li><a href="cluster-computing.html#the-bottleneck-and-its-solution">The bottleneck and its solution<span></span></a></li>
<li><a href="cluster-computing.html#lambda-architecture">Lambda Architecture<span></span></a></li>
<li><a href="cluster-computing.html#hadoop">Hadoop<span></span></a></li>
<li><a href="cluster-computing.html#spark">Spark<span></span></a></li>
<li><a href="cluster-computing.html#exercises-18">Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="dashboards.html"><a href="dashboards.html"><i class="fa fa-check"></i><b>19</b> Dashboards<span></span></a>
<ul>
<li><a href="dashboards.html#the-value-of-dashboards">The value of dashboards<span></span></a></li>
<li><a href="dashboards.html#designing-a-dashboard">Designing a dashboard<span></span></a></li>
<li><a href="dashboards.html#dashboards-with-r">Dashboards with R<span></span></a></li>
<li><a href="dashboards.html#conclusion-5">Conclusion<span></span></a></li>
<li><a href="dashboards.html#exercises-19">Exercises<span></span></a></li>
</ul></li>
<li><a href="section-4-managing-organizational-memory.html#section-4-managing-organizational-memory">Section 4 Managing Organizational Memory<span></span></a></li>
<li class="chapter" data-level="20" data-path="data-structure-and-storage.html"><a href="data-structure-and-storage.html"><i class="fa fa-check"></i><b>20</b> Data Structure and Storage<span></span></a>
<ul>
<li><a href="data-structure-and-storage.html#the-data-deluge">The data deluge<span></span></a></li>
<li><a href="data-structure-and-storage.html#data-structures-1">Data structures<span></span></a></li>
<li><a href="data-structure-and-storage.html#data-coding-standards">Data coding standards<span></span></a></li>
<li><a href="data-structure-and-storage.html#data-storage-devices">Data storage devices<span></span></a></li>
<li><a href="data-structure-and-storage.html#data-compression">Data compression<span></span></a></li>
<li><a href="data-structure-and-storage.html#key-terms-and-concepts-15">Key terms and concepts<span></span></a></li>
<li><a href="data-structure-and-storage.html#exercises-20">Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="data-processing-architectures.html"><a href="data-processing-architectures.html"><i class="fa fa-check"></i><b>21</b> Data Processing Architectures<span></span></a>
<ul>
<li><a href="data-processing-architectures.html#architectural-choices">Architectural choices<span></span></a></li>
<li><a href="data-processing-architectures.html#remote-job-entry">Remote job entry<span></span></a></li>
<li><a href="data-processing-architectures.html#personal-database">Personal database<span></span></a></li>
<li><a href="data-processing-architectures.html#clientserver">Client/server<span></span></a></li>
<li><a href="data-processing-architectures.html#cloud-computing">Cloud computing<span></span></a></li>
<li><a href="data-processing-architectures.html#distributed-database">Distributed database<span></span></a></li>
<li><a href="data-processing-architectures.html#distributed-data-access">Distributed data access<span></span></a></li>
<li><a href="data-processing-architectures.html#distributed-database-design">Distributed database design<span></span></a></li>
<li><a href="data-processing-architectures.html#key-terms-and-concepts-16">Key terms and concepts<span></span></a></li>
<li><a href="data-processing-architectures.html#exercises-21">Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="sql-and-java.html"><a href="sql-and-java.html"><i class="fa fa-check"></i><b>22</b> SQL and Java<span></span></a>
<ul>
<li><a href="sql-and-java.html#java">JAVA<span></span></a></li>
<li><a href="sql-and-java.html#using-sql-within-java">Using SQL within Java<span></span></a></li>
<li><a href="sql-and-java.html#javaserver-pages-jsp">JavaServer Pages (JSP)<span></span></a></li>
<li><a href="sql-and-java.html#exercises-22">Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="data-integrity.html"><a href="data-integrity.html"><i class="fa fa-check"></i><b>23</b> Data Integrity<span></span></a>
<ul>
<li><a href="data-integrity.html#introduction-2">Introduction<span></span></a></li>
<li><a href="data-integrity.html#transaction-management">Transaction management<span></span></a></li>
<li><a href="data-integrity.html#protecting-existence">Protecting existence<span></span></a></li>
<li><a href="data-integrity.html#maintaining-data-quality">Maintaining data quality<span></span></a></li>
<li><a href="data-integrity.html#ensuring-confidentiality">Ensuring confidentiality<span></span></a></li>
<li><a href="data-integrity.html#key-terms-and-concepts-18">Key terms and concepts<span></span></a></li>
<li><a href="data-integrity.html#exercises-23">Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="data-administration.html"><a href="data-administration.html"><i class="fa fa-check"></i><b>24</b> Data Administration<span></span></a>
<ul>
<li><a href="data-administration.html#introduction-3">Introduction<span></span></a></li>
<li><a href="data-administration.html#the-chief-data-officer">The Chief Data Officer<span></span></a></li>
<li><a href="data-administration.html#management-of-the-database-environment">Management of the database environment<span></span></a></li>
<li><a href="data-administration.html#data-administration-1">Data administration<span></span></a></li>
<li><a href="data-administration.html#database-management-systems-dbmss">Database management systems (DBMSs)<span></span></a></li>
<li><a href="data-administration.html#groupware-1">Groupware<span></span></a></li>
<li><a href="data-administration.html#data-integration">Data integration<span></span></a></li>
<li><a href="data-administration.html#conclusion-9">Conclusion<span></span></a></li>
<li><a href="data-administration.html#exercises-24">Exercises<span></span></a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sql-and-java" class="section level1 hasAnchor" number="22">
<h1><span class="header-section-number">Chapter 22</span> SQL and Java<a href="sql-and-java.html#sql-and-java" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote>
<p><em>The vision for Java is to be the concrete and nails that people use
to build this incredible network system that is happening all around
us.</em></p>
<p>James Gosling, 2000</p>
</blockquote>
<div id="learning-objectives-21" class="section level3 unnumbered hasAnchor">
<h3>Learning objectives<a href="sql-and-java.html#learning-objectives-21" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Students completing this chapter will be able to
- write Java program to process a parameterized SQL query;
- read a CSV file and insert rows into tables;
- write a program using HMTL and JavaServer Pages (JSP) to insert data
collected by a form data into a relational database;
- understand how SQL commands are used for transaction processing.</p>
</div>
<div id="java" class="section level2 unnumbered hasAnchor">
<h2>JAVA<a href="sql-and-java.html#java" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Java is a platform-independent application development language. Its
object-oriented nature makes it easy to create and maintain software and
prototypes. These features make Java an attractive development language
for many applications, including database systems.</p>
<p>This chapter assumes that you have some knowledge of Java programming,
can use an integrated development environment (IDE) (e.g., BlueJ,
Eclipse, or NetBeans), and know how to use a Java library. It is also
requires some HTML skills because JavaServer Pages (JSP) are created by
embedding Java code within an HTML document. MySQL is used for all the
examples, but the fundamental principles are the same for all relational
databases. With a few changes, your program will work with another
implementation of the relational model.</p>
<div id="jdbc" class="section level3 unnumbered hasAnchor">
<h3>JDBC<a href="sql-and-java.html#jdbc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Java Database Connectivity (JDBC), a Java version of a portable SQL
command line interface (CLI), is modeled on Open Database Connectivity
(ODBC.) JDBC enables programmers to write Java software that is both
operating system and DBMS independent. The JDBC core, which handles 90
percent of database programming, contains seven interfaces and two
classes, which are part of the java.sql package. The purpose of each of
these is summarized in the following table.</p>
<p><em>JDBC core interfaces and classes</em></p>
<table>
<colgroup>
<col width="56%" />
<col width="43%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Interfaces</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Connection</td>
<td align="left">Connects an application to a database</td>
</tr>
<tr class="even">
<td align="left">Statement</td>
<td align="left">A container for an SQL statement</td>
</tr>
<tr class="odd">
<td align="left">PreparedStatement</td>
<td align="left">Precompiles an SQL statement and then uses it multiple times</td>
</tr>
<tr class="even">
<td align="left">CallableStatement</td>
<td align="left">Executes a stored procedure</td>
</tr>
<tr class="odd">
<td align="left">ResultSet</td>
<td align="left">The rows returned when a query is executed</td>
</tr>
<tr class="even">
<td align="left">ResultSetMetaData</td>
<td align="left">The number, types, and properties of the result set</td>
</tr>
<tr class="odd">
<td align="left">Classes</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">DriverManager</td>
<td align="left">Loads driver objects and creates database connections</td>
</tr>
<tr class="odd">
<td align="left">DriverPropertyInfo</td>
<td align="left">Used by specialized clients</td>
</tr>
</tbody>
</table>
<p>For each DBMS, implementations of these interfaces are required because
they are specific to the DBMS and not part of the Java package. For
example, specific drivers are needed for MySQL, DB2, Oracle, and MS SQL.
Before using JDBC, you will need to install these interfaces for the
DBMS you plan to access. The standard practice appears to be to refer to
this set of interfaces as the driver, but the ‘driver’ also includes
implementations of all the interfaces.</p>
</div>
<div id="java-ee" class="section level3 unnumbered hasAnchor">
<h3>Java EE<a href="sql-and-java.html#java-ee" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Java EE (Java Platform Enterprise Edition) is a platform for
multi-tiered enterprise applications. In the typical three-tier model, a
Java EE application server sits between the client’s browser and the
database server. A Java EE compliant server, of which there are a
variety, is needed to process JSP.</p>
</div>
</div>
<div id="using-sql-within-java" class="section level2 unnumbered hasAnchor">
<h2>Using SQL within Java<a href="sql-and-java.html#using-sql-within-java" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this section, you will need a Java integrated development environment
to execute the sample code. A good option is <a href="https://www.eclipse.org">Eclipse</a>, a widely used open source IDE.</p>
<p>We now examine each of the major steps in processing an SQL query and,
in the process, create Java methods to query a database.</p>
<div id="connect-to-the-database" class="section level3 unnumbered hasAnchor">
<h3>Connect to the database<a href="sql-and-java.html#connect-to-the-database" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The getConnection method of the DriverManager specifies the URL of the
database, the account identifier, and its password. You cannot assume
that connecting to the database will be trouble-free. Thus, good coding
practice requires that you detect and report any errors using Java’s
try-catch structure.</p>
<p>You connect to a DBMS by supplying its url and the account name and
password.</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb435-1"><a href="sql-and-java.html#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span> <span class="op">{</span></span>
<span id="cb435-2"><a href="sql-and-java.html#cb435-2" aria-hidden="true" tabindex="-1"></a>    conn <span class="op">=</span> <span class="bu">DriverManager</span><span class="op">.</span><span class="fu">getConnection</span><span class="op">(</span>url<span class="op">,</span> account<span class="op">,</span> password<span class="op">);</span></span>
<span id="cb435-3"><a href="sql-and-java.html#cb435-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">catch</span> <span class="op">(</span><span class="bu">SQLException</span> error<span class="op">)</span> <span class="op">{</span></span>
<span id="cb435-4"><a href="sql-and-java.html#cb435-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Error connecting to database: &quot;</span> <span class="op">+</span> error<span class="op">.</span><span class="fu">toString</span><span class="op">());</span></span>
<span id="cb435-5"><a href="sql-and-java.html#cb435-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">System</span><span class="op">.</span><span class="fu">exit</span><span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb435-6"><a href="sql-and-java.html#cb435-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>The format of the url parameter varies with the JDBC driver, and you
will need to consult the documentation for the driver. In the case of
MySQL, the possible formats are</p>
<p>jdbc:mysql:database</p>
<p>jdbc:mysql://host/database</p>
<p>jdbc:mysql://host:port/database</p>
<p>The default value for host is “localhost” and, for MySQL, the default
port is “3306.”</p>
<p>For example:</p>
<p>jdbc:mysql://www.richardtwatson.com:3306/Text will enable connection to the database Text on the host
<a href="http://www.richardtwatson.com" class="uri">http://www.richardtwatson.com</a> on port 3306.</p>
</div>
<div id="create-and-execute-an-sql-statement" class="section level3 unnumbered hasAnchor">
<h3>Create and execute an SQL statement<a href="sql-and-java.html#create-and-execute-an-sql-statement" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The prepareStatement method is invoked to produce a Statement object
(see the following code). Note that the conn in conn.prepareStatement()
refers to the connection created by the getConnection method. Parameters
are used in prepareStatement to set execution time values, with each
parameter indicated by a question mark (?). Parameters are identified by
an integer for the order in which they appear in the SQL statement. In
the following sample code, shrdiv is a parameter and is set to indiv by
stmt.setInit(1,indiv), where 1 is its identifier (i.e., the first
parameter in the SQL statement) and indiv is the parameter. The value of
indiv is received as input at run time.</p>
<p>The SQL query is run by the executeQuery() method of the Statement
object. The results are returned in a ResultSet object.</p>
<p><em>Create and execute an SQL statement</em></p>
<div class="sourceCode" id="cb436"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb436-1"><a href="sql-and-java.html#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span> <span class="op">{</span></span>
<span id="cb436-2"><a href="sql-and-java.html#cb436-2" aria-hidden="true" tabindex="-1"></a>    stmt <span class="op">=</span> conn<span class="op">.</span><span class="fu">prepareStatement</span><span class="op">(</span><span class="st">&quot;SELECT shrfirm, shrdiv FROM shr WHERE shrdiv &gt; ?&quot;</span><span class="op">);</span></span>
<span id="cb436-3"><a href="sql-and-java.html#cb436-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// set the value for shrdiv to indiv</span></span>
<span id="cb436-4"><a href="sql-and-java.html#cb436-4" aria-hidden="true" tabindex="-1"></a>    stmt<span class="op">.</span><span class="fu">setInt</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span>indiv<span class="op">);</span></span>
<span id="cb436-5"><a href="sql-and-java.html#cb436-5" aria-hidden="true" tabindex="-1"></a>    rs <span class="op">=</span> stmt<span class="op">.</span><span class="fu">executeQuery</span><span class="op">();</span></span>
<span id="cb436-6"><a href="sql-and-java.html#cb436-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb436-7"><a href="sql-and-java.html#cb436-7" aria-hidden="true" tabindex="-1"></a><span class="cf">catch</span> <span class="op">(</span><span class="bu">SQLException</span> error<span class="op">)</span></span>
<span id="cb436-8"><a href="sql-and-java.html#cb436-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb436-9"><a href="sql-and-java.html#cb436-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Error reporting from database: &quot;</span></span>
<span id="cb436-10"><a href="sql-and-java.html#cb436-10" aria-hidden="true" tabindex="-1"></a>            <span class="op">+</span> error<span class="op">.</span><span class="fu">toString</span><span class="op">());</span></span>
<span id="cb436-11"><a href="sql-and-java.html#cb436-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">exit</span><span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb436-12"><a href="sql-and-java.html#cb436-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
</div>
<div id="report-a-select" class="section level3 unnumbered hasAnchor">
<h3>Report a SELECT<a href="sql-and-java.html#report-a-select" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The rows in the table containing the results of the query are processed
a row at a time using the next method of the ResultSet object (see the
following code). Columns are retrieved one at a time using a get method
within a loop, where the integer value specified in the method call
refers to a column (e.g., rs.getString(1) returns the first column of
the result set as a string). The get method used depends on the type of
data returned by the query. For example, getString() gets a character
string, getInt() gets an integer, and so on.</p>
<p><em>Reporting a SELECT</em></p>
<div class="sourceCode" id="cb437"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb437-1"><a href="sql-and-java.html#cb437-1" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(</span>rs<span class="op">.</span><span class="fu">next</span><span class="op">())</span> <span class="op">{</span></span>
<span id="cb437-2"><a href="sql-and-java.html#cb437-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">String</span> firm <span class="op">=</span> rs<span class="op">.</span><span class="fu">getString</span><span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb437-3"><a href="sql-and-java.html#cb437-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> div <span class="op">=</span> rs<span class="op">.</span><span class="fu">getInt</span><span class="op">(</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb437-4"><a href="sql-and-java.html#cb437-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>firm <span class="op">+</span> <span class="st">&quot; &quot;</span> <span class="op">+</span> div<span class="op">);</span></span>
<span id="cb437-5"><a href="sql-and-java.html#cb437-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="inserting-a-row" class="section level3 unnumbered hasAnchor">
<h3>Inserting a row<a href="sql-and-java.html#inserting-a-row" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The prepareStatement() is also used for inserting a row in a similar
manner, as the following example shows. The executeUpdate() method
performs the insert. Notice the use of try and catch to detect and
report an error during an insert.</p>
<p><em>Inserting a row</em></p>
<div class="sourceCode" id="cb438"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb438-1"><a href="sql-and-java.html#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span> <span class="op">{</span></span>
<span id="cb438-2"><a href="sql-and-java.html#cb438-2" aria-hidden="true" tabindex="-1"></a>    stmt <span class="op">=</span> conn<span class="op">.</span><span class="fu">prepareStatement</span><span class="op">(</span><span class="st">&quot;INSERT INTO alien (alnum, alname) VALUES (?,?)&quot;</span><span class="op">);</span></span>
<span id="cb438-3"><a href="sql-and-java.html#cb438-3" aria-hidden="true" tabindex="-1"></a>    stmt<span class="op">.</span><span class="fu">setInt</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span><span class="dv">10</span><span class="op">);</span></span>
<span id="cb438-4"><a href="sql-and-java.html#cb438-4" aria-hidden="true" tabindex="-1"></a>    stmt<span class="op">.</span><span class="fu">setString</span><span class="op">(</span><span class="dv">2</span><span class="op">,</span> <span class="st">&quot;ET&quot;</span><span class="op">);</span></span>
<span id="cb438-5"><a href="sql-and-java.html#cb438-5" aria-hidden="true" tabindex="-1"></a>    stmt<span class="op">.</span><span class="fu">executeUpdate</span><span class="op">();</span></span>
<span id="cb438-6"><a href="sql-and-java.html#cb438-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb438-7"><a href="sql-and-java.html#cb438-7" aria-hidden="true" tabindex="-1"></a><span class="cf">catch</span> <span class="op">(</span><span class="bu">SQLException</span> error<span class="op">)</span></span>
<span id="cb438-8"><a href="sql-and-java.html#cb438-8" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb438-9"><a href="sql-and-java.html#cb438-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Error inserting row into database: &quot;</span></span>
<span id="cb438-10"><a href="sql-and-java.html#cb438-10" aria-hidden="true" tabindex="-1"></a>     <span class="op">+</span> error<span class="op">.</span><span class="fu">toString</span><span class="op">());</span></span>
<span id="cb438-11"><a href="sql-and-java.html#cb438-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">System</span><span class="op">.</span><span class="fu">exit</span><span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb438-12"><a href="sql-and-java.html#cb438-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="release-the-statement-object" class="section level3 unnumbered hasAnchor">
<h3>Release the Statement object<a href="sql-and-java.html#release-the-statement-object" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The resources associated with the various objects created are freed as
follows:</p>
<p>stmt.close();</p>
<p>rs.close();</p>
<p>conn.close();</p>
<p>To illustrate the use of Java, a pair of programs is available. The
first, DataTest.java, creates a database connection and then calls a
method to execute and report an SQL. The second program,
DatabaseAccess.java, contains the methods called by the first. Both
programs are available on the book’s web site for examination and use.</p>
<blockquote>
<p>❓ <em>Skill builder</em></p>
<ol style="list-style-type: decimal">
<li><p>Get from this book’s supporting Web site the code of
DatabaseTest.java and DatabaseAccess.java.</p></li>
<li><p>Inspect the code to learn how you use SQL from within a Java
application.</p></li>
<li><p>Run DatabaseTest.java with a few different values for indiv.</p></li>
<li><p>Make modifications to query a different table.</p></li>
</ol>
</blockquote>
</div>
<div id="loading-a-text-file-into-a-database" class="section level3 unnumbered hasAnchor">
<h3>Loading a text file into a database<a href="sql-and-java.html#loading-a-text-file-into-a-database" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Java is useful when you have a dataset that you need to load into a
database. For example, you might have set up a spreadsheet and later
realized that it would be more efficient to use a database. In this
case, you can export the spreadsheet and load the data into one or more
tables.</p>
<p>We will illustrate loading data from a text file into the ArtCollection
database with the following design. Notice that there different tables
for different types of art, paintings, and sculptures in this case. The code for creating the database is <a href="http://richardtwatson.com/open/Reader/java.html">online</a></p>
<p><em>ArtCollection data model</em></p>
<p><img src="Figures/Chapter%2022/ArtCollection.png" /></p>
<div id="csv-file" class="section level4 unnumbered hasAnchor">
<h4>CSV file<a href="sql-and-java.html#csv-file" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A <a href="http://en.wikipedia.org/wiki/Comma-separated_values">comma-separated values</a> (CSV) file is a common form of text file
because most spreadsheet programs offer it as an export option. There
are a variety of options available in terms of the separator for fields
(usually a comma or tab) and the use of quotation marks to denote text
fields. Usually, each record has the same number of fields. Frequently,
the first record contains names for each of the fields. Notice in the
example file that follows that a record contains details of an artist
and one piece of that person’s art. As the data model specifies, these
two sets of data go into separate tables.</p>
<p><em>A CSV file</em></p>
<pre class="eval"><code>firstName,lastName,birthyear,deathyear,nationality,title,length,breadth,year,style,medium
Edvard,Munch,1863,1944,Norwegian,The Scream,36,29,1893,Cubist,Oil
Claude,Monet,1840,1926,French,Bridge over a Pond of Water
Lilies,36,29,1899,Impressionist,Oil
Toulouse,Lautrec,1864,1901,French,Avril,55,33,1893,Impressionist,Oil
Vincent,Van Gogh,1853,1890,French,The Starry
Night,29,36,1889,Impressionist,Oil
Johannes,Vermeer,1632,1675,Dutch,Girl with a Pearl
Earring,17,15,1665,Impressionist,Oil
Salvador,Dali,1904,1989,Spanish,The Persistence of
Memory,9.5,13,1931,Surreal,Oil
Andrew,Wyeth,1917,2009,American,Christina&#39;s World
,32,47,1948,Surreal,Oil
William,Turner,1789,1862,English,The Battle of
Trafalgar,103,145,1822,Surreal,Oil
Tom,Roberts,1856,1931,Australian,Shearing the
Rams,48,72,1890,Surreal,Oil
Paul,Gauguin,1848,1903,French,Spirit of the Dead
Watching,28,36,1892,Surreal,Watercolor</code></pre>
<p>Because CSV files are so widely used, there are Java libraries for
processing them. We have opted for <a href="http://sourceforge.net/projects/javacsv/">CsvReader</a>. Here is some code for
connecting to a CSV file defined by its URL. You can also connect to
text files on your personal computer.</p>
<p><em>Connecting to a CSV file</em></p>
<div class="sourceCode" id="cb440"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb440-1"><a href="sql-and-java.html#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span> <span class="op">{</span></span>
<span id="cb440-2"><a href="sql-and-java.html#cb440-2" aria-hidden="true" tabindex="-1"></a>    csvurl <span class="op">=</span> <span class="kw">new</span> <span class="bu">URL</span><span class="op">(</span><span class="st">&quot;http://www.richardtwatson.com/data/painting.csv&quot;</span><span class="op">);</span></span>
<span id="cb440-3"><a href="sql-and-java.html#cb440-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">catch</span> <span class="op">(</span><span class="bu">IOException</span> error<span class="op">)</span> <span class="op">{</span></span>
<span id="cb440-4"><a href="sql-and-java.html#cb440-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Error accessing url: &quot;</span> <span class="op">+</span> error<span class="op">.</span><span class="fu">toString</span><span class="op">());</span></span>
<span id="cb440-5"><a href="sql-and-java.html#cb440-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">System</span><span class="op">.</span><span class="fu">exit</span><span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb440-6"><a href="sql-and-java.html#cb440-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>A CSV file is read a record at a time, and the required fields are
extracted for further processing. The following code illustrates how a
loop is used to read each record in a CSV file and extract some fields.
Note the following:
- The first record, the header, contains the names of each field and
is read before the loop starts.
- Field names can be used to extract each field with a get() method.
- You often need to convert the input string data to another format,
such as integer.
- Methods, addArtist, and addArt are included in the loop to add
details of an artist to the artist table and a piece of art to the
art table.</p>
<p><em>Processing a CSV file</em></p>
<div class="sourceCode" id="cb441"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb441-1"><a href="sql-and-java.html#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span> <span class="op">{</span></span>
<span id="cb441-2"><a href="sql-and-java.html#cb441-2" aria-hidden="true" tabindex="-1"></a>    input <span class="op">=</span> <span class="kw">new</span> <span class="fu">CsvReader</span><span class="op">(</span><span class="kw">new</span> <span class="bu">InputStreamReader</span><span class="op">(</span>csvurl<span class="op">.</span><span class="fu">openStream</span><span class="op">()));</span></span>
<span id="cb441-3"><a href="sql-and-java.html#cb441-3" aria-hidden="true" tabindex="-1"></a>    input<span class="op">.</span><span class="fu">readHeaders</span><span class="op">();</span></span>
<span id="cb441-4"><a href="sql-and-java.html#cb441-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>input<span class="op">.</span><span class="fu">readRecord</span><span class="op">())</span></span>
<span id="cb441-5"><a href="sql-and-java.html#cb441-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb441-6"><a href="sql-and-java.html#cb441-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Artist</span></span>
<span id="cb441-7"><a href="sql-and-java.html#cb441-7" aria-hidden="true" tabindex="-1"></a>        <span class="bu">String</span> firstName <span class="op">=</span> input<span class="op">.</span><span class="fu">get</span><span class="op">(</span><span class="st">&quot;firstName&quot;</span><span class="op">);</span></span>
<span id="cb441-8"><a href="sql-and-java.html#cb441-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">String</span> lastName <span class="op">=</span> input<span class="op">.</span><span class="fu">get</span><span class="op">(</span><span class="st">&quot;lastName&quot;</span><span class="op">);</span></span>
<span id="cb441-9"><a href="sql-and-java.html#cb441-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">String</span> nationality <span class="op">=</span> input<span class="op">.</span><span class="fu">get</span><span class="op">(</span><span class="st">&quot;nationality&quot;</span><span class="op">);</span></span>
<span id="cb441-10"><a href="sql-and-java.html#cb441-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> birthYear <span class="op">=</span> <span class="bu">Integer</span><span class="op">.</span><span class="fu">parseInt</span><span class="op">(</span>input<span class="op">.</span><span class="fu">get</span><span class="op">(</span><span class="st">&quot;birthyear&quot;</span><span class="op">));</span></span>
<span id="cb441-11"><a href="sql-and-java.html#cb441-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> deathYear <span class="op">=</span> <span class="bu">Integer</span><span class="op">.</span><span class="fu">parseInt</span><span class="op">(</span>input<span class="op">.</span><span class="fu">get</span><span class="op">(</span><span class="st">&quot;deathyear&quot;</span><span class="op">));</span></span>
<span id="cb441-12"><a href="sql-and-java.html#cb441-12" aria-hidden="true" tabindex="-1"></a>        artistPK <span class="op">=</span> <span class="fu">addArtist</span><span class="op">(</span>conn<span class="op">,</span> firstName<span class="op">,</span> lastName<span class="op">,</span> nationality<span class="op">,</span> birthYear<span class="op">,</span> deathYear<span class="op">);</span></span>
<span id="cb441-13"><a href="sql-and-java.html#cb441-13" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Painting</span></span>
<span id="cb441-14"><a href="sql-and-java.html#cb441-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">String</span> title <span class="op">=</span> input<span class="op">.</span><span class="fu">get</span><span class="op">(</span><span class="st">&quot;title&quot;</span><span class="op">);</span></span>
<span id="cb441-15"><a href="sql-and-java.html#cb441-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> length <span class="op">=</span> <span class="bu">Double</span><span class="op">.</span><span class="fu">parseDouble</span><span class="op">(</span>input<span class="op">.</span><span class="fu">get</span><span class="op">(</span><span class="st">&quot;length&quot;</span><span class="op">));</span></span>
<span id="cb441-16"><a href="sql-and-java.html#cb441-16" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> breadth <span class="op">=</span> <span class="bu">Double</span><span class="op">.</span><span class="fu">parseDouble</span><span class="op">(</span>input<span class="op">.</span><span class="fu">get</span><span class="op">(</span><span class="st">&quot;breadth&quot;</span><span class="op">));</span></span>
<span id="cb441-17"><a href="sql-and-java.html#cb441-17" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> year <span class="op">=</span> <span class="bu">Integer</span><span class="op">.</span><span class="fu">parseInt</span><span class="op">(</span>input<span class="op">.</span><span class="fu">get</span><span class="op">(</span><span class="st">&quot;year&quot;</span><span class="op">));</span></span>
<span id="cb441-18"><a href="sql-and-java.html#cb441-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">addArt</span><span class="op">(</span>conn<span class="op">,</span> title<span class="op">,</span> length<span class="op">,</span> breadth<span class="op">,</span> year<span class="op">,</span>artistPK<span class="op">);</span></span>
<span id="cb441-19"><a href="sql-and-java.html#cb441-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb441-20"><a href="sql-and-java.html#cb441-20" aria-hidden="true" tabindex="-1"></a>input<span class="op">.</span><span class="fu">close</span><span class="op">();</span></span>
<span id="cb441-21"><a href="sql-and-java.html#cb441-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">catch</span> <span class="op">(</span><span class="bu">IOException</span> error<span class="op">)</span> <span class="op">{</span></span>
<span id="cb441-22"><a href="sql-and-java.html#cb441-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Error reading CSV file: &quot;</span> <span class="op">+</span> error<span class="op">.</span><span class="fu">toString</span><span class="op">());</span></span>
<span id="cb441-23"><a href="sql-and-java.html#cb441-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">System</span><span class="op">.</span><span class="fu">exit</span><span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb441-24"><a href="sql-and-java.html#cb441-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>We now need to consider the addArtist method. Its purpose is to add a
row to the artist table. The primary key, artistID, is specified as
AUTO_INCREMENT, which means it is set by the DBMS. Because of the 1:m
relationship between artist and art, we need to know the value of
artistID, the primary key of art, to set the foreign key for the
corresponding piece of art. We can use the following code to determine
the primary key of the last insert.</p>
<p><em>Determining the value of the primary key of the last insert</em></p>
<div class="sourceCode" id="cb442"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb442-1"><a href="sql-and-java.html#cb442-1" aria-hidden="true" tabindex="-1"></a>rs <span class="op">=</span> stmt<span class="op">.</span><span class="fu">executeQuery</span><span class="op">(</span><span class="st">&quot;SELECT LAST_INSERT_ID()&quot;</span><span class="op">);</span></span>
<span id="cb442-2"><a href="sql-and-java.html#cb442-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>rs<span class="op">.</span><span class="fu">next</span><span class="op">())</span> <span class="op">{</span></span>
<span id="cb442-3"><a href="sql-and-java.html#cb442-3" aria-hidden="true" tabindex="-1"></a>        autoIncKey <span class="op">=</span> rs<span class="op">.</span><span class="fu">getInt</span><span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb442-4"><a href="sql-and-java.html#cb442-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>The addArtist method returns the value of the primary key of the most
recent insert so that we can then use this value as the foreign key for
the related piece of art.</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb443-1"><a href="sql-and-java.html#cb443-1" aria-hidden="true" tabindex="-1"></a>artistPK <span class="op">=</span> <span class="fu">addArtist</span><span class="op">(</span>conn<span class="op">,</span> firstName<span class="op">,</span> lastName<span class="op">,</span> nationality<span class="op">,</span> birthYear<span class="op">,</span> deathYear<span class="op">);</span></span></code></pre></div>
<p>The call to the addArt method includes the returned value as a
parameter. That is, it passes the primary key of artist to be used as
foreign key of art.</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb444-1"><a href="sql-and-java.html#cb444-1" aria-hidden="true" tabindex="-1"></a><span class="fu">addArt</span><span class="op">(</span>conn<span class="op">,</span> title<span class="op">,</span> length<span class="op">,</span> breadth<span class="op">,</span> year<span class="op">,</span>artistPK<span class="op">);</span></span></code></pre></div>
<p>The Java code for the complete application is available on the book’s
<a href="http://richardtwatson.com/dm6e/Reader/java.html">web site</a>.</p>
<blockquote>
<p>❓ <strong>Skill builder</strong></p>
<ol style="list-style-type: decimal">
<li><p>Add a few sculptors and a piece of sculpture to the CSV file.
Also, decide how you will differentiate between a painting and a
sculpture.</p></li>
<li><p>Add a method to ArtCollector.java to insert an artist and that
person’s sculpture.</p></li>
<li><p>Run the revised program so that it adds both paintings and<br />
sculptures for various artists.</p></li>
</ol>
</blockquote>
</div>
</div>
</div>
<div id="javaserver-pages-jsp" class="section level2 unnumbered hasAnchor">
<h2>JavaServer Pages (JSP)<a href="sql-and-java.html#javaserver-pages-jsp" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Standard HTML pages are static. They contain text and graphics that
don’t change unless someone recodes the page. JSP and other
technologies, such as PHP and ASP, enable you to create dynamic pages
whose content can change based to suit the goals of the person accessing
the page, the browser used, or the device on which the page is
displayed.</p>
<p>A JSP contains standard HTML code, the static, and JSP elements, the
dynamic. When someone requests a JSP, the server combines HTML and JSP
elements to deliver a dynamic page. JSP is also useful for server side
processing. For example, when someone submits a form, JSP elements can
be used to process the form on the server.</p>
<div id="map-collection-case" class="section level3 unnumbered hasAnchor">
<h3>Map collection case<a href="sql-and-java.html#map-collection-case" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Expeditioner has added a new product line to meet the needs of its
changing clientele. It now stocks a range of maps. The firm’s data
modeler has created a data model describing the situation . A map has a
scale; for example, a scale of 1:1 000 000 means that 1 unit on the map
is 1,000,000 units on the ground (or 1 cm is 10 km, and 1 inch is ~16
miles). There are three types of maps: road, rail, and canal. Initially,
The Expeditioner decided to stock maps for only a few European
countries.</p>
<p><em>The Expeditioner’s map collection data model</em></p>
<p><img src="Figures/Chapter%2022/map-collection.png" /></p>
<div id="data-entry" class="section level4 unnumbered hasAnchor">
<h4>Data entry<a href="sql-and-java.html#data-entry" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Once the tables have been defined, we want to insert some records. This
could be done using the insertSQL method of the Java code just created,
but it would be very tedious, as we would type insert statements for
each row (e.g., INSERT INTO map VALUES (1, 1000000, ‘Rail’);). A better
approach is to use a HTML data entry form. An appropriate form and its
associated code follow.</p>
<p><em>Map collection data entry form</em></p>
<p><img src="Figures/Chapter%2022/data-entry.png" /></p>
<p><em>Map collection data entry HTML code (index.html)</em></p>
<div class="sourceCode" id="cb445"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb445-1"><a href="sql-and-java.html#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;!DOCTYPE </span>html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;<span class="dt">&gt;</span></span>
<span id="cb445-2"><a href="sql-and-java.html#cb445-2" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="cb445-3"><a href="sql-and-java.html#cb445-3" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;head&gt;</span></span>
<span id="cb445-4"><a href="sql-and-java.html#cb445-4" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;meta</span> <span class="er">http-equiv</span><span class="ot">=</span><span class="st">&quot;Content-Type&quot;</span> <span class="er">content</span><span class="ot">=</span><span class="st">&quot;text/html; charset=ISO-8859-1&quot;</span><span class="kw">&gt;</span></span>
<span id="cb445-5"><a href="sql-and-java.html#cb445-5" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;title&gt;</span>Map collection<span class="kw">&lt;/title&gt;</span></span>
<span id="cb445-6"><a href="sql-and-java.html#cb445-6" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="cb445-7"><a href="sql-and-java.html#cb445-7" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="cb445-8"><a href="sql-and-java.html#cb445-8" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;form</span> <span class="er">name</span><span class="ot">=</span><span class="st">&quot;MapInsert&quot;</span> <span class="er">action</span><span class="ot">=</span><span class="st">&quot;mapinsert.jsp&quot;</span> <span class="er">method</span><span class="ot">=</span><span class="st">&quot;post&quot;</span><span class="kw">&gt;</span></span>
<span id="cb445-9"><a href="sql-and-java.html#cb445-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;p&gt;</span></span>
<span id="cb445-10"><a href="sql-and-java.html#cb445-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;label&gt;</span>Map identifier: <span class="kw">&lt;input</span> <span class="er">type</span><span class="ot">=</span><span class="st">&quot;number&quot;</span> <span class="er">required</span></span>
<span id="cb445-11"><a href="sql-and-java.html#cb445-11" aria-hidden="true" tabindex="-1"></a><span class="ot">            pattern=</span><span class="st">&quot;[0-9]{3}&quot;</span> <span class="er">name</span><span class="ot">=</span><span class="st">&quot;mapid&quot;</span> <span class="er">size</span><span class="ot">=</span><span class="st">&quot;24&quot;</span> <span class="er">value</span><span class="ot">=</span><span class="st">&quot;&quot;</span></span>
<span id="cb445-12"><a href="sql-and-java.html#cb445-12" aria-hidden="true" tabindex="-1"></a><span class="ot">            placeholder=</span><span class="st">&quot;Enter map identifier&quot;</span><span class="kw">&gt;&lt;/label&gt;</span></span>
<span id="cb445-13"><a href="sql-and-java.html#cb445-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;p&gt;</span></span>
<span id="cb445-14"><a href="sql-and-java.html#cb445-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;label&gt;</span>Map scale: <span class="kw">&lt;input</span> <span class="er">type</span><span class="ot">=</span><span class="st">&quot;number&quot;</span> <span class="er">required</span></span>
<span id="cb445-15"><a href="sql-and-java.html#cb445-15" aria-hidden="true" tabindex="-1"></a><span class="ot">            pattern=</span><span class="st">&quot;[0-9]+&quot;</span> <span class="er">min</span><span class="ot">=</span><span class="st">&quot;1000&quot;</span> <span class="er">max</span><span class="ot">=</span><span class="st">&quot;100000&quot;</span> <span class="er">step</span><span class="ot">=</span><span class="st">&quot;1000&quot;</span> <span class="er">name</span><span class="ot">=</span><span class="st">&quot;mapscale&quot;</span></span>
<span id="cb445-16"><a href="sql-and-java.html#cb445-16" aria-hidden="true" tabindex="-1"></a><span class="ot">            size=</span><span class="st">&quot;24&quot;</span> <span class="er">value</span><span class="ot">=</span><span class="st">&quot;&quot;</span> <span class="er">placeholder</span><span class="ot">=</span><span class="st">&quot;Enter 1:1000 as 1000&quot;</span><span class="kw">&gt;&lt;/label&gt;</span></span>
<span id="cb445-17"><a href="sql-and-java.html#cb445-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;p&gt;</span></span>
<span id="cb445-18"><a href="sql-and-java.html#cb445-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;label&gt;</span>Map type: <span class="kw">&lt;select</span> <span class="er">name</span><span class="ot">=</span><span class="st">&quot;maptype&quot;</span> <span class="er">size</span><span class="ot">=</span><span class="st">&quot;3&quot;</span></span>
<span id="cb445-19"><a href="sql-and-java.html#cb445-19" aria-hidden="true" tabindex="-1"></a><span class="ot">            placeholder=</span><span class="st">&quot;Select type of map&quot;</span><span class="kw">&gt;&lt;/label&gt;</span></span>
<span id="cb445-20"><a href="sql-and-java.html#cb445-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;/p&gt;</span></span>
<span id="cb445-21"><a href="sql-and-java.html#cb445-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;option</span> <span class="er">value</span><span class="ot">=</span><span class="st">&quot;Bicycle&quot;</span><span class="kw">&gt;</span>Bicycle<span class="kw">&lt;/option&gt;</span></span>
<span id="cb445-22"><a href="sql-and-java.html#cb445-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;option</span> <span class="er">value</span><span class="ot">=</span><span class="st">&quot;Canal&quot;</span><span class="kw">&gt;</span>Canal<span class="kw">&lt;/option&gt;</span></span>
<span id="cb445-23"><a href="sql-and-java.html#cb445-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;option</span> <span class="er">value</span><span class="ot">=</span><span class="st">&quot;Rail&quot;</span> <span class="er">selected</span><span class="kw">&gt;</span>Rail<span class="kw">&lt;/option&gt;</span></span>
<span id="cb445-24"><a href="sql-and-java.html#cb445-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;option</span> <span class="er">value</span><span class="ot">=</span><span class="st">&quot;Road&quot;</span><span class="kw">&gt;</span>Road<span class="kw">&lt;/option&gt;</span></span>
<span id="cb445-25"><a href="sql-and-java.html#cb445-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;/select&gt;</span> <span class="kw">&lt;label&gt;</span>Countries: <span class="kw">&lt;select</span> <span class="er">name</span><span class="ot">=</span><span class="st">&quot;countries&quot;</span> <span class="er">size</span><span class="ot">=</span><span class="st">&quot;4&quot;</span> <span class="er">multiple</span></span>
<span id="cb445-26"><a href="sql-and-java.html#cb445-26" aria-hidden="true" tabindex="-1"></a><span class="ot">        placeholder=</span><span class="st">&quot;Select countries&quot;</span><span class="kw">&gt;&lt;/label&gt;</span></span>
<span id="cb445-27"><a href="sql-and-java.html#cb445-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;option</span> <span class="er">value</span><span class="ot">=</span><span class="st">&quot;at&quot;</span><span class="kw">&gt;</span>Austria<span class="kw">&lt;/option&gt;</span></span>
<span id="cb445-28"><a href="sql-and-java.html#cb445-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;option</span> <span class="er">value</span><span class="ot">=</span><span class="st">&quot;de&quot;</span><span class="kw">&gt;</span>Germany<span class="kw">&lt;/option&gt;</span></span>
<span id="cb445-29"><a href="sql-and-java.html#cb445-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;option</span> <span class="er">value</span><span class="ot">=</span><span class="st">&quot;li&quot;</span><span class="kw">&gt;</span>Liechtenstein<span class="kw">&lt;/option&gt;</span></span>
<span id="cb445-30"><a href="sql-and-java.html#cb445-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;option</span> <span class="er">value</span><span class="ot">=</span><span class="st">&quot;ch&quot;</span><span class="kw">&gt;</span>Switzerland<span class="kw">&lt;/option&gt;</span></span>
<span id="cb445-31"><a href="sql-and-java.html#cb445-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;input</span> <span class="er">type</span><span class="ot">=</span><span class="st">&quot;submit&quot;</span> <span class="er">name</span><span class="ot">=</span><span class="st">&quot;submitbutton&quot;</span> <span class="er">value</span><span class="ot">=</span><span class="st">&quot;Add map&quot;</span><span class="kw">&gt;</span></span>
<span id="cb445-32"><a href="sql-and-java.html#cb445-32" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/form&gt;</span></span>
<span id="cb445-33"><a href="sql-and-java.html#cb445-33" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="cb445-34"><a href="sql-and-java.html#cb445-34" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
<p>The data entry form captures a map’s identifier, scale, type, and the
number of countries covered by the map. A map identifier is of the form
M001 to M999, and a regular expression is used to validate the
input.[ A map scale must be numeric with a minimum of 1000 and
maximum of 100000 in increments of 1000. The type of map is selected
from the list, which is defined so that only one type can be selected.
Multiple countries can be selected by holding down an appropriate key
combination when selected from the displayed list of countries. When the
“Add map” button is clicked, the page mapinsert.jsp is called, which is
specified in the first line of the HTML body code.</p>
</div>
<div id="passing-data-from-a-form-to-a-jsp" class="section level4 unnumbered hasAnchor">
<h4>Passing data from a form to a JSP<a href="sql-and-java.html#passing-data-from-a-form-to-a-jsp" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In a form, the various entry fields are each identified by a name
specification (e.g., name=“mapid” and name=“mapscale”). In the
corresponding JSP, which is the one defined in the form’s action
statement (i.e., action=“mapinsert.jsp”) these same fields are accessed
using the getParameter method when there is a single value or
getParameterValues when there are multiple values. The following chunks
of code show corresponding form and JSP code for maptype.</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb446-1"><a href="sql-and-java.html#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;label&gt;</span>Map type: <span class="kw">&lt;select</span> <span class="er">name</span><span class="ot">=</span><span class="st">&quot;maptype&quot;</span> <span class="er">size</span><span class="ot">=</span><span class="st">&quot;3&quot;</span></span>
<span id="cb446-2"><a href="sql-and-java.html#cb446-2" aria-hidden="true" tabindex="-1"></a><span class="ot">            placeholder=</span><span class="st">&quot;Select type of map&quot;</span><span class="kw">&gt;&lt;/label&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb447"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb447-1"><a href="sql-and-java.html#cb447-1" aria-hidden="true" tabindex="-1"></a>maptype <span class="op">=</span> request<span class="op">.</span><span class="fu">getParameter</span><span class="op">(</span><span class="st">&quot;maptype&quot;</span><span class="op">);</span></span></code></pre></div>
</div>
<div id="transaction-processing" class="section level4 unnumbered hasAnchor">
<h4>Transaction processing<a href="sql-and-java.html#transaction-processing" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A transaction is a logical unit of work. In the case of adding a map, it
means inserting a row in map for the map and inserting one row in
mapCountry for each country on the map. All of these inserts must be
executed without failure for the entire transaction to be processed. SQL
has two commands for supporting transaction processing: COMMIT and
ROLLBACK. If no errors are detected, then the various changes made by a
transaction can be <em>committed</em>. In the event of any errors during the
processing of a transaction, the database should be <em>rolled back</em> to the
state prior to the transaction.</p>
<div id="autocommit" class="section level5 unnumbered hasAnchor">
<h5>Autocommit<a href="sql-and-java.html#autocommit" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Before processing a transaction, you need to turn off autocommit to
avoid committing each database change separately before the entire
transaction is complete. It is a good idea to set the value for
autocommit immediately after a successful database connection, which is
what you will see when you inspect the code for mapinsert.jsp. The
following code sets autocommit to false in the case where conn is the
connection object.</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb448-1"><a href="sql-and-java.html#cb448-1" aria-hidden="true" tabindex="-1"></a>conn<span class="op">.</span><span class="fu">setAutoCommit</span><span class="op">(</span><span class="kw">false</span><span class="op">);</span></span></code></pre></div>
</div>
<div id="commit" class="section level5 unnumbered hasAnchor">
<h5>Commit<a href="sql-and-java.html#commit" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The COMMIT command is executed when all parts of a transaction have been
successfully executed. It makes the changes to the database permanent.</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb449-1"><a href="sql-and-java.html#cb449-1" aria-hidden="true" tabindex="-1"></a>conn<span class="op">.</span><span class="fu">commit</span><span class="op">();</span> <span class="co">// all inserts successful</span></span></code></pre></div>
</div>
<div id="rollback" class="section level5 unnumbered hasAnchor">
<h5>Rollback<a href="sql-and-java.html#rollback" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The ROLLBACK command is executed when any part of a transaction fails.
All changes to the database since the beginning of the transaction are
reversed, and the database is restored to its state before the
transaction commenced.</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb450-1"><a href="sql-and-java.html#cb450-1" aria-hidden="true" tabindex="-1"></a>conn<span class="op">.</span><span class="fu">rollback</span><span class="op">();</span> <span class="co">// at least one insert failed</span></span></code></pre></div>
</div>
<div id="completing-the-transaction" class="section level5 unnumbered hasAnchor">
<h5>Completing the transaction<a href="sql-and-java.html#completing-the-transaction" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The final task, to commit or roll back the transaction depending on
whether errors were detected during any of the inserts, is determined by
examining transOK, which is a boolean variable set to false when any
errors are detected during a transaction.</p>
<p><em>Completing the transaction</em></p>
<div class="sourceCode" id="cb451"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb451-1"><a href="sql-and-java.html#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>transOK<span class="op">)</span> <span class="op">{</span></span>
<span id="cb451-2"><a href="sql-and-java.html#cb451-2" aria-hidden="true" tabindex="-1"></a>    conn<span class="op">.</span><span class="fu">commit</span><span class="op">();</span> <span class="co">// all inserts successful</span></span>
<span id="cb451-3"><a href="sql-and-java.html#cb451-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb451-4"><a href="sql-and-java.html#cb451-4" aria-hidden="true" tabindex="-1"></a>    conn<span class="op">.</span><span class="fu">rollback</span><span class="op">();</span> <span class="co">// at least one insert failed</span></span>
<span id="cb451-5"><a href="sql-and-java.html#cb451-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb451-6"><a href="sql-and-java.html#cb451-6" aria-hidden="true" tabindex="-1"></a>conn<span class="op">.</span><span class="fu">close</span><span class="op">();</span> <span class="co">// close database</span></span></code></pre></div>
</div>
</div>
<div id="putting-it-all-together" class="section level4 unnumbered hasAnchor">
<h4>Putting it all together<a href="sql-and-java.html#putting-it-all-together" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>You have now seen some of the key pieces for the event handler that
processes a transaction to add a map and the countries on that map. The
<a href="http://richardtwatson.com/open/Reader/java.html">code</a> can be downloaded from the book’s Web site.</p>
<p><em>mapinsert.jsp</em></p>
<div class="sourceCode" id="cb452"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb452-1"><a href="sql-and-java.html#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span>%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=ISO-8859-1&quot;</span>
<span id="cb452-2"><a href="sql-and-java.html#cb452-2" aria-hidden="true" tabindex="-1"></a>    pageEncoding=&quot;ISO-8859-1&quot;%&gt;</span>
<span id="cb452-3"><a href="sql-and-java.html#cb452-3" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;!DOCTYPE </span>html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;<span class="dt">&gt;</span></span>
<span id="cb452-4"><a href="sql-and-java.html#cb452-4" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span>%@ page import=&quot;java.util.*&quot;%&gt;</span>
<span id="cb452-5"><a href="sql-and-java.html#cb452-5" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span>%@ page import=&quot;java.lang.*&quot;%&gt;</span>
<span id="cb452-6"><a href="sql-and-java.html#cb452-6" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span>%@ page import=&quot;java.sql.*&quot;%&gt;</span>
<span id="cb452-7"><a href="sql-and-java.html#cb452-7" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="cb452-8"><a href="sql-and-java.html#cb452-8" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;head&gt;</span></span>
<span id="cb452-9"><a href="sql-and-java.html#cb452-9" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;meta</span> <span class="er">http-equiv</span><span class="ot">=</span><span class="st">&quot;Content-Type&quot;</span> <span class="er">content</span><span class="ot">=</span><span class="st">&quot;text/html; charset=ISO-8859-1&quot;</span><span class="kw">&gt;</span></span>
<span id="cb452-10"><a href="sql-and-java.html#cb452-10" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;title&gt;</span>Map insert page<span class="kw">&lt;/title&gt;</span></span>
<span id="cb452-11"><a href="sql-and-java.html#cb452-11" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="cb452-12"><a href="sql-and-java.html#cb452-12" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;body&gt;</span></span>
<span id="cb452-13"><a href="sql-and-java.html#cb452-13" aria-hidden="true" tabindex="-1"></a>    <span class="er">&lt;</span>%</span>
<span id="cb452-14"><a href="sql-and-java.html#cb452-14" aria-hidden="true" tabindex="-1"></a>    String url;</span>
<span id="cb452-15"><a href="sql-and-java.html#cb452-15" aria-hidden="true" tabindex="-1"></a>    String jdbc = &quot;jdbc:mysql:&quot;;</span>
<span id="cb452-16"><a href="sql-and-java.html#cb452-16" aria-hidden="true" tabindex="-1"></a>    String database = &quot;//localhost:3306/MapCollection&quot;;</span>
<span id="cb452-17"><a href="sql-and-java.html#cb452-17" aria-hidden="true" tabindex="-1"></a>    String username = &quot;student&quot;, password = &quot;student&quot;;</span>
<span id="cb452-18"><a href="sql-and-java.html#cb452-18" aria-hidden="true" tabindex="-1"></a>    String mapid, maptype, countries;</span>
<span id="cb452-19"><a href="sql-and-java.html#cb452-19" aria-hidden="true" tabindex="-1"></a>    String[] country;</span>
<span id="cb452-20"><a href="sql-and-java.html#cb452-20" aria-hidden="true" tabindex="-1"></a>    int mapscale = 0;</span>
<span id="cb452-21"><a href="sql-and-java.html#cb452-21" aria-hidden="true" tabindex="-1"></a>    boolean transOK = true;</span>
<span id="cb452-22"><a href="sql-and-java.html#cb452-22" aria-hidden="true" tabindex="-1"></a>    PreparedStatement insertMap;</span>
<span id="cb452-23"><a href="sql-and-java.html#cb452-23" aria-hidden="true" tabindex="-1"></a>    PreparedStatement insertMapCountry;</span>
<span id="cb452-24"><a href="sql-and-java.html#cb452-24" aria-hidden="true" tabindex="-1"></a>    Connection conn = null;</span>
<span id="cb452-25"><a href="sql-and-java.html#cb452-25" aria-hidden="true" tabindex="-1"></a>    // make connection</span>
<span id="cb452-26"><a href="sql-and-java.html#cb452-26" aria-hidden="true" tabindex="-1"></a>    url = jdbc + database;</span>
<span id="cb452-27"><a href="sql-and-java.html#cb452-27" aria-hidden="true" tabindex="-1"></a>    try {</span>
<span id="cb452-28"><a href="sql-and-java.html#cb452-28" aria-hidden="true" tabindex="-1"></a>        conn = DriverManager.getConnection(url, username, password);</span>
<span id="cb452-29"><a href="sql-and-java.html#cb452-29" aria-hidden="true" tabindex="-1"></a>    } catch (SQLException error) {</span>
<span id="cb452-30"><a href="sql-and-java.html#cb452-30" aria-hidden="true" tabindex="-1"></a>        System.out.println(&quot;Error connecting to database: &quot;</span>
<span id="cb452-31"><a href="sql-and-java.html#cb452-31" aria-hidden="true" tabindex="-1"></a>                    + error.toString());</span>
<span id="cb452-32"><a href="sql-and-java.html#cb452-32" aria-hidden="true" tabindex="-1"></a>        System.exit(1);</span>
<span id="cb452-33"><a href="sql-and-java.html#cb452-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb452-34"><a href="sql-and-java.html#cb452-34" aria-hidden="true" tabindex="-1"></a>    try {</span>
<span id="cb452-35"><a href="sql-and-java.html#cb452-35" aria-hidden="true" tabindex="-1"></a>        conn.setAutoCommit(false);</span>
<span id="cb452-36"><a href="sql-and-java.html#cb452-36" aria-hidden="true" tabindex="-1"></a>    } catch (SQLException error) {</span>
<span id="cb452-37"><a href="sql-and-java.html#cb452-37" aria-hidden="true" tabindex="-1"></a>        System.out.println(&quot;Error turning off autocommit&quot;</span>
<span id="cb452-38"><a href="sql-and-java.html#cb452-38" aria-hidden="true" tabindex="-1"></a>                    + error.toString());</span>
<span id="cb452-39"><a href="sql-and-java.html#cb452-39" aria-hidden="true" tabindex="-1"></a>        System.exit(2);</span>
<span id="cb452-40"><a href="sql-and-java.html#cb452-40" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb452-41"><a href="sql-and-java.html#cb452-41" aria-hidden="true" tabindex="-1"></a>    //form data</span>
<span id="cb452-42"><a href="sql-and-java.html#cb452-42" aria-hidden="true" tabindex="-1"></a>    mapid = request.getParameter(&quot;mapid&quot;);</span>
<span id="cb452-43"><a href="sql-and-java.html#cb452-43" aria-hidden="true" tabindex="-1"></a>    mapscale = Integer.parseInt(request.getParameter(&quot;mapscale&quot;));</span>
<span id="cb452-44"><a href="sql-and-java.html#cb452-44" aria-hidden="true" tabindex="-1"></a>    maptype = request.getParameter(&quot;maptype&quot;);</span>
<span id="cb452-45"><a href="sql-and-java.html#cb452-45" aria-hidden="true" tabindex="-1"></a>    country = request.getParameterValues(&quot;countries&quot;);</span>
<span id="cb452-46"><a href="sql-and-java.html#cb452-46" aria-hidden="true" tabindex="-1"></a>    transOK = true;</span>
<span id="cb452-47"><a href="sql-and-java.html#cb452-47" aria-hidden="true" tabindex="-1"></a>    // insert the map</span>
<span id="cb452-48"><a href="sql-and-java.html#cb452-48" aria-hidden="true" tabindex="-1"></a>    try {</span>
<span id="cb452-49"><a href="sql-and-java.html#cb452-49" aria-hidden="true" tabindex="-1"></a>        insertMap = conn.prepareStatement(&quot;INSERT INTO map (mapid, mapscale, maptype) VALUES (?,?,?)&quot;);</span>
<span id="cb452-50"><a href="sql-and-java.html#cb452-50" aria-hidden="true" tabindex="-1"></a>        insertMap.setString(1, mapid);</span>
<span id="cb452-51"><a href="sql-and-java.html#cb452-51" aria-hidden="true" tabindex="-1"></a>        insertMap.setInt(2, mapscale);</span>
<span id="cb452-52"><a href="sql-and-java.html#cb452-52" aria-hidden="true" tabindex="-1"></a>        insertMap.setString(3, maptype);</span>
<span id="cb452-53"><a href="sql-and-java.html#cb452-53" aria-hidden="true" tabindex="-1"></a>        System.out.println(insertMap);</span>
<span id="cb452-54"><a href="sql-and-java.html#cb452-54" aria-hidden="true" tabindex="-1"></a>        insertMap.executeUpdate();</span>
<span id="cb452-55"><a href="sql-and-java.html#cb452-55" aria-hidden="true" tabindex="-1"></a>        // insert the countries</span>
<span id="cb452-56"><a href="sql-and-java.html#cb452-56" aria-hidden="true" tabindex="-1"></a>        for (int loopInx = 0; loopInx <span class="er">&lt;</span> country.length; loopInx++) {</span>
<span id="cb452-57"><a href="sql-and-java.html#cb452-57" aria-hidden="true" tabindex="-1"></a>            insertMapCountry = conn.prepareStatement(&quot;INSERT INTO mapCountry (mapid ,cntrycode ) VALUES (?,?)&quot;);</span>
<span id="cb452-58"><a href="sql-and-java.html#cb452-58" aria-hidden="true" tabindex="-1"></a>            insertMapCountry.setString(1, mapid);</span>
<span id="cb452-59"><a href="sql-and-java.html#cb452-59" aria-hidden="true" tabindex="-1"></a>            insertMapCountry.setString(2, country[loopInx]);</span>
<span id="cb452-60"><a href="sql-and-java.html#cb452-60" aria-hidden="true" tabindex="-1"></a>            System.out.println(insertMapCountry);</span>
<span id="cb452-61"><a href="sql-and-java.html#cb452-61" aria-hidden="true" tabindex="-1"></a>            insertMapCountry.executeUpdate();</span>
<span id="cb452-62"><a href="sql-and-java.html#cb452-62" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb452-63"><a href="sql-and-java.html#cb452-63" aria-hidden="true" tabindex="-1"></a>    } catch (SQLException error) {</span>
<span id="cb452-64"><a href="sql-and-java.html#cb452-64" aria-hidden="true" tabindex="-1"></a>        System.out.println(&quot;Error inserting row: &quot; + error.toString());</span>
<span id="cb452-65"><a href="sql-and-java.html#cb452-65" aria-hidden="true" tabindex="-1"></a>        transOK = false;</span>
<span id="cb452-66"><a href="sql-and-java.html#cb452-66" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb452-67"><a href="sql-and-java.html#cb452-67" aria-hidden="true" tabindex="-1"></a>    if (transOK) {</span>
<span id="cb452-68"><a href="sql-and-java.html#cb452-68" aria-hidden="true" tabindex="-1"></a>        conn.commit(); // all inserts successful</span>
<span id="cb452-69"><a href="sql-and-java.html#cb452-69" aria-hidden="true" tabindex="-1"></a>        System.out.println(&quot;Transaction commit&quot;);</span>
<span id="cb452-70"><a href="sql-and-java.html#cb452-70" aria-hidden="true" tabindex="-1"></a>    } else {</span>
<span id="cb452-71"><a href="sql-and-java.html#cb452-71" aria-hidden="true" tabindex="-1"></a>        conn.rollback(); // at least one insert failed</span>
<span id="cb452-72"><a href="sql-and-java.html#cb452-72" aria-hidden="true" tabindex="-1"></a>        System.out.println(&quot;Transaction rollback&quot;);</span>
<span id="cb452-73"><a href="sql-and-java.html#cb452-73" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb452-74"><a href="sql-and-java.html#cb452-74" aria-hidden="true" tabindex="-1"></a>    conn.close();</span>
<span id="cb452-75"><a href="sql-and-java.html#cb452-75" aria-hidden="true" tabindex="-1"></a>    System.out.println(&quot;Database close&quot;); // close database</span>
<span id="cb452-76"><a href="sql-and-java.html#cb452-76" aria-hidden="true" tabindex="-1"></a>    %&gt;</span>
<span id="cb452-77"><a href="sql-and-java.html#cb452-77" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="cb452-78"><a href="sql-and-java.html#cb452-78" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
<p>The code in mapinsert.jsp does the following:</p>
<ol style="list-style-type: decimal">
<li><p>Creates a connection to a database</p></li>
<li><p>Gets the data from the map entry form</p></li>
<li><p>Inserts a row for a new map</p></li>
<li><p>Uses a loop to insert a row for each country on the map</p></li>
<li><p>Shows how to handle a transaction failure.</p></li>
</ol>
</div>
</div>
<div id="conclusion-8" class="section level3 unnumbered hasAnchor">
<h3>Conclusion<a href="sql-and-java.html#conclusion-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Java is a widely used object-oriented programming language for
developing distributed multi-tier applications. JDBC is a key technology
in this environment because it enables a Java application to interact
with various implementations of the relational database model (e.g.,
Oracle, SQL Server, MySQL). As this chapter has demonstrated, with the
help of a few examples, JDBC can be readily understood and applied.</p>
</div>
<div id="summary-22" class="section level3 unnumbered hasAnchor">
<h3>Summary<a href="sql-and-java.html#summary-22" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Java is a platform-independent application development language. JDBC
enables programs that are DBMS independent. SQL statements can be
embedded within Java programs. JSP is used to support server side
processing. COMMIT and ROLLBACK are used for transaction processing.</p>
</div>
<div id="key-terms-and-concepts-17" class="section level3 unnumbered hasAnchor">
<h3>Key terms and concepts<a href="sql-and-java.html#key-terms-and-concepts-17" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<table>
<tbody>
<tr class="odd">
<td align="left">Autocommit</td>
<td align="left">Java Database Connectivity (JDBC)</td>
</tr>
<tr class="even">
<td align="left">Comma-separated values</td>
<td align="left">Java Server Pages (JSP)</td>
</tr>
<tr class="odd">
<td align="left">COMMIT</td>
<td align="left">ROLLBACK</td>
</tr>
<tr class="even">
<td align="left">IDE</td>
<td align="left">Transaction processing</td>
</tr>
<tr class="odd">
<td align="left">Java</td>
<td align="left"></td>
</tr>
</tbody>
</table>
</div>
<div id="references-and-additional-readings-11" class="section level3 unnumbered hasAnchor">
<h3>References and additional readings<a href="sql-and-java.html#references-and-additional-readings-11" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Barnes, D. J., and M. Kölling. 2005. <em>Objects first with Java : a
practical introduction using Blue J</em>. 2nd ed. Upper Saddle River, NJ:
Prentice Hall.</p>
</div>
</div>
<div id="exercises-22" class="section level2 unnumbered hasAnchor">
<h2>Exercises<a href="sql-and-java.html#exercises-22" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Write a Java program to run a parameterized query against the
ClassicModels database. For example, you might report the sum of
payments for a given customer’s name.</li>
</ol>
<p>Extend ArtCollection.java so that it can handle inserting rows for
multiple pieces of art for a single artist. You will have to rethink the
structure of the CSV file and how to record multiple pieces of art from
a single artist.</p>
<ol start="2" style="list-style-type: decimal">
<li>Write a JSP application to maintain the database defined by the
following data model. The database keeps track of the cars sold by a
salesperson in an automotive dealership. Your application should be
able to add a person and the cars a person has sold. These should be
separate transactions.</li>
</ol>
<p><img src="Figures/Chapter%2022/person-car.png" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-processing-architectures.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-integrity.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["DataManagement.pdf", "DataManagement.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
